<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nossa Musica</title>
    <!-- Favicon (ícone da aba) -->
    <link id="favicon" rel="icon" href="#">
    <!-- Tailwind CSS para estilização rápida e responsiva -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Poppins para uma aparência moderna -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Estilos personalizados para complementar o Tailwind */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #121212; /* Cor de fundo escura padrão do Spotify */
        }

        /* Estilizando a barra de rolagem para um visual mais limpo */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e1e1e;
        }
        ::-webkit-scrollbar-thumb {
            background: #535353;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #7a7a7a;
        }

        /* Animação da barra de progresso do Story */
        .story-progress-bar-segment {
            animation: progressBar 5s linear forwards;
        }

        @keyframes progressBar {
            from { width: 0%; }
            to { width: 100%; }
        }
        
        /* Transição suave entre as páginas */
        .page {
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .page.hidden {
            transform: translateX(100%);
        }
        #lyrics-page.hidden {
             transform: translateY(100%);
        }
        
        /* Animação de pulso para o botão Play */
        .pulse-play {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }
        
        /* Cor verde para botões ativos */
        .active-icon {
            color: #1DB954; /* Verde Spotify */
        }

    </style>
    <script>
        // Função para lidar com erros de imagem. Colocada no <head> para garantir que esteja definida antes do <body> ser renderizado.
        function handleImageError(image) {
            // Se a imagem .jpg falhar, tenta carregar a .png
            const currentSrc = image.src;
            if (currentSrc.endsWith('.jpg')) {
                image.onerror = null; // Evita um loop infinito se o .png também falhar
                image.src = currentSrc.replace('.jpg', '.png');
            }
        }
    </script>
</head>
<body class="bg-black text-white overflow-hidden">
    <!-- NOTIFICAÇÃO DE MÚSICA -->
    <div id="notification" class="fixed top-10 left-1/2 -translate-x-1/2 bg-[#1DB954] text-white px-6 py-3 rounded-full shadow-lg text-sm font-semibold z-[100] opacity-0 transition-all duration-500 ease-in-out pointer-events-none transform -translate-y-10">
        Tocando: <span id="notification-song-name"></span>
    </div>

    <!-- Player de áudio invisível -->
    <audio id="audio-player" crossorigin="anonymous"></audio>

    <!-- Container principal que segura as duas "páginas" -->
    <div class="relative h-screen w-full">

        <!-- PÁGINA PRINCIPAL (com rolagem) -->
        <div id="main-page" class="absolute inset-0 page bg-[#121212] overflow-y-auto">
            <div class="container mx-auto max-w-lg min-h-full flex flex-col px-4 pt-10 pb-4">
                <!-- CABEÇALHO -->
                <header class="flex justify-between items-center mb-6 flex-shrink-0">
                    <div class="w-6 h-6"></div>
                    <span class="text-sm font-bold">Tocando Agora</span>
                    <div class="relative">
                        <button id="menu-btn" class="focus:outline-none">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path></svg>
                        </button>
                        <div id="header-menu" class="hidden absolute right-0 mt-2 w-48 bg-[#282828] rounded-md shadow-lg z-50">
                            <a href="https://wa.me/5515981072147" target="_blank" class="flex items-center space-x-3 px-4 py-3 text-sm text-white hover:bg-[#3e3e3e] rounded-md">
                                <!-- WhatsApp Icon SVG -->
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.487 5.235 3.487 8.413 0 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 4.315 1.731 6.086l.001.004l.351.568l-1.251 4.605l4.672-1.225l.531.315z"></path></svg>
                                <span>Enviar no WhatsApp</span>
                            </a>
                        </div>
                    </div>
                </header>

                <main class="flex-grow">
                    <!-- CAPA DA MÚSICA -->
                    <div class="mb-6">
                        <div id="album-art-container" class="relative w-full rounded-lg shadow-2xl aspect-square overflow-hidden">
                            <!-- Imagens serão inseridas aqui via JavaScript -->
                        </div>
                    </div>

                    <!-- TÍTULO E ARTISTA -->
                    <div class="flex justify-between items-center mb-4">
                        <div>
                            <h1 id="song-title" class="text-2xl font-bold"></h1>
                            <p id="song-artist" class="text-gray-400"></p>
                        </div>
                        <svg class="w-6 h-6 text-green-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    </div>

                    <!-- CONTROLES DE MÚSICA -->
                    <div class="mb-8">
                        <div id="main-progress-bar" class="bg-gray-700 rounded-full h-1 w-full mb-1 cursor-pointer"><div id="main-progress" class="bg-white rounded-full h-1" style="width: 0%;"></div></div>
                        <div class="flex justify-between text-xs text-gray-400"><span id="main-current-time">0:00</span><span id="main-total-time">0:00</span></div>
                        <div class="flex justify-center items-center space-x-8 mt-4 px-4">
                            <button id="main-prev-btn">
                                <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8.445 14.832A1 1 0 0010 14.006V5.994a1 1 0 00-1.555-.832L2.4 9.168a1 1 0 000 1.664l6.045 4.001zM11 5h2v10h-2V5z" clip-rule="evenodd"></path></svg>
                            </button>
                            <button id="main-play-btn" class="w-12 h-12 text-white rounded-full"></button>
                            <button id="main-next-btn">
                                <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.555 5.168A1 1 0 0010 5.994v8.012a1 1 0 001.555.832l6.045-4.001a1 1 0 000-1.664l-6.045-4.001zM9 5H7v10h2V5z" clip-rule="evenodd"></path></svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- CARD "LETRA" -->
                    <div id="lyrics-card" class="bg-[#191414] rounded-lg p-6 cursor-pointer mb-8 flex flex-col items-start">
                        <h2 class="text-xl font-bold mb-2">Nossa Letra</h2>
                        <p class="text-gray-300 text-sm mb-4 line-clamp-4">Você me disse no ônibus que você era a minha última opção. Mas, sabe de uma coisa? Você sempre foi a minha primeira opção, a minha paixão de anos e anos...</p>
                        <button class="bg-white text-black text-sm font-bold py-2 px-4 rounded-full hover:scale-105 transition-transform">
                            Mostrar Letra
                        </button>
                    </div>

                    <!-- SEÇÃO DE STORIES -->
                    <div class="mb-8">
                         <h2 class="text-xl font-bold mb-4">Momentos Especiais</h2>
                         <div id="stories-container" class="flex space-x-4 overflow-x-auto pb-4"></div>
                    </div>

                     <!-- SEÇÃO RETROSPECTIVA -->
                    <div class="mb-8">
                         <h2 class="text-xl font-bold mb-4">Retrospectiva</h2>
                         <div id="retrospective-card" class="bg-[#191414] rounded-lg p-4 flex items-center space-x-4 cursor-pointer hover:bg-[#282828] transition-colors">
                             <img src="https://placehold.co/100x100/1DB954/FFFFFF?text=2024" alt="Retrospectiva" class="w-24 h-24 rounded-lg object-cover flex-shrink-0">
                             <div>
                                 <p class="text-gray-400 text-sm">Playlist</p>
                                 <h3 class="text-lg font-bold">Nossa Retrospectiva 2024</h3>
                                 <p class="text-gray-400 text-sm">Os momentos que marcaram nosso ano.</p>
                             </div>
                         </div>
                    </div>

                    <!-- SEÇÃO EVENTOS -->
                    <div class="mb-8">
                         <h2 class="text-xl font-bold mb-4">Eventos</h2>
                         <div id="events-container" class="flex space-x-4 overflow-x-auto pb-4"></div>
                    </div>

                    <!-- SEÇÃO ARTISTA -->
                    <div class="mb-8">
                         <h2 class="text-xl font-bold mb-4">Sobre o Artista</h2>
                         <div class="bg-[#191414] rounded-lg p-4 flex items-center space-x-4">
                             <img src="minhafoto.jpg" alt="Foto do Artista" class="w-24 h-24 rounded-full object-cover flex-shrink-0" onerror="handleImageError(this)">
                             <div>
                                 <h3 class="text-lg font-bold">Guilherme Almeida</h3>
                                 <p class="text-gray-400 text-sm">Apenas um garoto apaixonado por musica que sempre dividiu playlist com sua melhor amiga, e que hoje quer dividir a sua vida com ela, Que Sorte a Dele!</p>
                             </div>
                         </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- PÁGINA DA LETRA (com layout fixo) -->
        <div id="lyrics-page" class="absolute inset-0 page bg-[#B45309] hidden grid grid-rows-[auto_1fr_auto]">
            <!-- Cabeçalho da página de letra -->
            <header class="flex justify-between items-center p-4 z-10 pt-10">
                <button id="back-to-main-btn">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                </button>
                <span id="lyrics-song-title" class="text-sm font-bold text-white"></span>
                <div class="w-6 h-6"></div>
            </header>

            <!-- Conteúdo da Letra (com rolagem) -->
            <div id="lyrics-content" class="overflow-y-auto px-6 pt-8 pb-8">
                <div class="text-white text-2xl font-bold space-y-4 text-center">
                    <p>Você me disse no ônibus que você era a minha última opção.</p>
                    <p>Mas, sabe de uma coisa? Você sempre foi a minha primeira opção, a minha paixão de anos e anos. Eu lembro que sempre que conhecia uma menina, eu não deixava passar demais porque eu gostava de você. Isso lá na época que tinha 17 anos, mais ou menos, e você 14.</p>
                    <p>Eu não lembro exatamente quando eu comecei a gostar de você, se foi exatamente nessa época ou se foi quando eu era mais novo ainda. Mas enfim, estava na minha mente: "quando ela fizer 18 anos, eu converso com ela". Eu era fissurado que você, a minha melhor amiga, fosse a minha esposa. E você era quem eu queria me casar. Eu gostava muito, muito de você, tanto que eu esperei anos até você fazer 18 anos.</p>
                    <p>Mas eu, como a pessoa mais imatura da face da terra, em fevereiro de 2020, combinei de sair com a Mari no carrinho pra conversar com ela sobre isso, porque tu ia fazer 18 dali a 9 meses e eu queria me preparar melhor pra esse evento KKK.</p>
                    <p>Mas a Mari foi, conversou com você e voltou e me deu um banho de água fria, que eu ia estragar a amizade e afins. Então, com medo disso acontecer, eu simplesmente deixei esse meu sonho de lado por não querer me afastar de você.</p>
                    <p>E as coisas foram acontecendo (namorei, terminei - detalhe: traumatizado). Dei um tempo pra mim de alguns meses pra me recuperar e teve um dia que me senti pronto para outro relacionamento. E não vou mentir, pensava em você, mas a trava que minha ex instalou ainda estava forte, que com o tempo foi ficando mais fraca, e mais fraca.</p>
                    <p>Tivemos o caso de você vir me procurar num momento inoportuno. E tudo isso, tudo isso, tanta história para no final a gente ter um final de semana só nosso no Rio de Janeiro e termos muito tempo para se reaproximar e reconectar. E horas e horas conversando no ônibus, e isso foi bom demais, deu para colocarmos em jogo isso, darmos uma chance ao nosso “gostava de você naquela época”.</p>
                    <p>Darmos uma chance ao sonho que tinha de namorar minha melhor amiga. Hoje eu vejo isso muito mais claro, percebo que também vacilei com você ao não ter tomado uma atitude antes. Já era pra gente estar casados há muito tempo, com 5 filhos (brincadeira kkkk), mas era para estarmos vivendo nossas vidas juntos há muito tempo. Me desculpa por demorar tanto para isso, a vida brincou demais com a gente.</p>
                    <p>Mas chegou a hora de revivermos isso, de darmos início à nossa história de amor.</p>
                    <p>Óbvio que não irei te pedir em namoro digitalmente, sou incapaz disso. Mas posso reafirmar meu amor por você aqui. Que daqui em diante, se você me permitir, você será a minha menina, quem eu irei cuidar e apoiar eternamente.</p>
                    <p>Quando a gente estava conversando no ônibus, eu não consigo descrever o sorriso que você deu depois que a gente conversou. Foi tão lindo, me quebrou na hora. E eu quero ver esse sorriso sempre, quero te fazer feliz e estar nos momentos bons e ruins da sua vida, como sempre estive. Só que agora não como seu melhor amigo, mas como namorado, noivo e futuro esposo.</p>
                    <p>Estava olhando a galeria de fotos, a gente tem tanta, mas tanta história juntos. Crescemos juntos. Foi muito legal criar esse mini Spotify de história para você, relembrei tanta coisa que passamos juntos, o quanto foi bom estar ao seu lado todos esses anos.</p>
                    <p>E espero que, a partir desse ano, a gente não adie mais, que possamos ser mais felizes ainda juntos. Que a nossa história nunca tenha um final feliz, porque nossa história nunca vai ter fim, porque eu te amo e você será a menina que eu sempre amarei! </p>
                </div>
            </div>

            <!-- Mini Player Fixo -->
            <footer class="p-4 bg-[#B45309]">
                <div id="lyrics-progress-bar" class="bg-white/30 rounded-full h-1 w-full mb-1 cursor-pointer"><div id="lyrics-progress" class="bg-white rounded-full h-1" style="width: 0%;"></div></div>
                <div class="flex justify-between text-xs text-white/80"><span id="lyrics-current-time">0:00</span><span id="lyrics-total-time">0:00</span></div>
                <div class="flex justify-center items-center space-x-8 mt-4">
                     <button id="lyrics-prev-btn">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8.445 14.832A1 1 0 0010 14.006V5.994a1 1 0 00-1.555-.832L2.4 9.168a1 1 0 000 1.664l6.045 4.001zM11 5h2v10h-2V5z" clip-rule="evenodd"></path></svg>
                     </button>
                     <button id="lyrics-play-btn" class="w-12 h-12 text-white"></button>
                     <button id="lyrics-next-btn">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.555 5.168A1 1 0 0010 5.994v8.012a1 1 0 001.555.832l6.045-4.001a1 1 0 000-1.664l-6.045-4.001zM9 5H7v10h2V5z" clip-rule="evenodd"></path></svg>
                     </button>
                </div>
            </footer>
        </div>

    </div>


    <!-- MODAL DO STORY (inicialmente oculto) -->
    <div id="story-modal" class="fixed inset-0 bg-black bg-opacity-95 flex-col p-4 z-50 hidden">
        <div id="story-progress-container" class="w-full flex space-x-1 h-1 mb-2">
            <!-- As barras de progresso serão geradas aqui -->
        </div>
        <div class="flex items-center justify-between mb-4">
            <div class="flex items-center space-x-2">
                 <img id="story-modal-avatar" src="" class="w-8 h-8 rounded-full object-cover" onerror="handleImageError(this)">
                 <span id="story-modal-title" class="font-semibold text-sm"></span>
            </div>
            <button id="close-story-btn" class="text-white text-2xl">&times;</button>
        </div>
        <div class="relative flex-grow w-full h-full rounded-lg overflow-hidden">
            <img id="story-modal-image" src="" class="absolute top-0 left-0 w-full h-full object-contain" onerror="handleImageError(this)">
            <!-- Camadas de navegação -->
            <div id="story-prev-zone" class="absolute left-0 top-0 h-full w-1/3"></div>
            <div id="story-next-zone" class="absolute right-0 top-0 h-full w-1/3"></div>
            <div class="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black to-transparent">
                 <p id="story-modal-text" class="text-white text-center text-lg"></p>
            </div>
        </div>
    </div>
    
    <!-- MODAL DO EVENTO PADRÃO (inicialmente oculto) -->
    <div id="ticket-event-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 hidden cursor-pointer">
        <div class="bg-gradient-to-br from-amber-600 to-orange-700 rounded-2xl shadow-2xl w-full max-w-sm text-white p-6 relative cursor-default transform transition-transform duration-300 scale-95 opacity-0">
            <div class="text-center mb-4">
                <h3 class="text-sm font-bold uppercase text-amber-200">Você ganhou um vale-presente!</h3>
                <h2 id="ticket-event-modal-title" class="text-3xl font-bold mt-1"></h2>
            </div>
            <div class="flex items-center justify-center my-8">
                <div class="w-24 h-24 bg-white/20 rounded-lg flex flex-col items-center justify-center shadow-inner">
                    <div class="text-xs font-bold text-white uppercase">Data</div>
                    <div id="calendar-animation" class="text-5xl font-bold">??</div>
                    <div class="text-xs font-bold text-amber-200">EM BREVE</div>
                </div>
            </div>
            <div class="bg-white/80 rounded-lg p-3 text-center">
                <p id="ticket-main-text" class="font-bold text-xl text-amber-800"></p>
                <p id="ticket-sub-text" class="text-xs text-gray-600"></p>
            </div>
        </div>
    </div>
    
    <!-- MODAL DO EVENTO CINEMA (inicialmente oculto) -->
    <div id="cinema-event-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 hidden cursor-pointer">
         <div class="bg-gradient-to-br from-indigo-600 to-purple-700 rounded-2xl shadow-2xl w-full max-w-sm text-white p-6 relative cursor-default transform transition-transform duration-300 scale-95 opacity-0">
            <div class="text-center mb-4">
                <h3 class="text-sm font-bold uppercase text-indigo-200">Um presente especial para nós!</h3>
                <h2 id="cinema-event-modal-title" class="text-3xl font-bold mt-1"></h2>
            </div>
            <div class="flex items-center justify-center space-x-4 my-8">
                <div class="w-24 h-24 bg-white/20 rounded-lg flex flex-col items-center justify-center shadow-inner">
                     <div class="text-7xl font-bold text-white">∞</div>
                </div>
                <div class="text-center">
                   <svg class="w-16 h-16 text-purple-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18 3v2h-2V3H8v2H6V3H4v18h2v-2h2v2h8v-2h2v2h2V3h-2zM8 17H6v-2h2v2zm0-4H6v-2h2v2zm0-4H6V7h2v2zm10 8h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V7h2v2z"></path></svg>
                </div>
            </div>
            <div class="bg-white/80 rounded-lg p-3 text-center">
                <p class="font-bold text-xl text-indigo-800">Vale Sessões Infinitas</p>
                <p class="text-xs text-gray-600">Para todas as vezes que quisermos.</p>
            </div>
        </div>
    </div>

     <!-- MODAL DO EVENTO ALEATORIO (inicialmente oculto) -->
    <div id="random-event-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 hidden cursor-pointer">
         <div class="bg-gradient-to-br from-teal-500 to-cyan-600 rounded-2xl shadow-2xl w-full max-w-sm text-white p-6 relative cursor-default transform transition-transform duration-300 scale-95 opacity-0">
            <div class="text-center mb-4">
                <h3 class="text-sm font-bold uppercase text-cyan-200">Um presente surpresa!</h3>
                <h2 id="random-event-modal-title" class="text-3xl font-bold mt-1"></h2>
            </div>
            <div class="flex items-center justify-center my-8">
                <div class="w-24 h-24 bg-white/20 rounded-lg flex flex-col items-center justify-center shadow-inner">
                     <div class="text-7xl font-bold text-white">∞</div>
                </div>
            </div>
            <div class="bg-white/80 rounded-lg p-3 text-center">
                <p class="font-bold text-xl text-teal-800">Vales Infinitos</p>
                <p class="text-xs text-gray-600">Da praia ao circo, a escolha é sua!</p>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Lógica para definir o favicon dinamicamente
            const faviconLink = document.getElementById('favicon');
            const imgPng = new Image();
            imgPng.src = 'favicon.png';
            imgPng.onload = function() {
                faviconLink.href = 'favicon.png';
            };
            imgPng.onerror = function() {
                // Se o .png falhar, tenta carregar o .jpg
                faviconLink.href = 'favicon.jpg';
            };

            // --- CONFIGURAÇÃO DOS DADOS ---
            const storiesData = [
                { title: 'O Início', text: 'Eramos crianças, nem sequer imaginavamos que estavamos crescendo que um dia ficariamos juntos', imageCount: 4 },
                { title: 'Pregação', text: 'Sempre servindo a jeová juntos', imageCount: 6 },
                { title: 'Cinemas', text: 'Maratonando de velozes a vingadores no cinema, e o melhor lilolilo', imageCount: 10 },
                { title: 'Pais', text: 'Um dia como pais da Sarah', imageCount: 4 },
                { title: 'Risadas', text: 'Os momentos mais simples são os melhores', imageCount: 10 },
            ];

            const eventsData = [
                { title: 'Beto Carrero', type: 'ticket', mainText: 'Vale 1 Ingresso', subText: 'Para um dia de pura adrenalina!'},
                { title: 'Cinema', type: 'cinema' },
                { title: 'Holambra', type: 'ticket', mainText: 'Vale 1 Passeio', subText: 'Para um dia entre as flores.'},
                { title: 'São Roque', type: 'ticket', mainText: 'Almoço e Passeio', subText: 'Um brinde a nós na rota do vinho.' },
                { title: 'Aleatório', type: 'random' }
            ];
            
            // --- PLAYLIST DE MÚSICAS ---
            // IMPORTANTE: Cole seus links diretos do Dropbox aqui.
            // Para obter o link direto, compartilhe o arquivo no Dropbox, copie o link
            // e troque o final "?dl=0" por "?raw=1".
            const musicPlaylist = [
                { url: 'https://dl.dropboxusercontent.com/scl/fi/yb8hj0ahfz7myyqd8dnp9/Indians-Oblivion.mp3?rlkey=1o7owturcr6o28h0zp4z35cok&st=9q3lbzex&dl', title: 'Nossa Trilha Sonora', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/8o8s2sypttxe8mf61mos0/Jorge-e-Mateus-Pra-que-Entender.mp3?rlkey=bnybyh5k6ga8zzcpta4jfugtq&st=ooqljc8i&dl', title: 'Está apenas começando', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/uct4ji08nhokl7jv5utv6/Bryan-Behr-A-Vida-Boa-Com-Voc.mp3?rlkey=217ayf7dj7mpz1771djhvm1xh&st=63kebtuc&dl', title: 'Cada nota, um Beijo', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/cib06xox1ki6uwtsy4lnc/Grouplove-Let-Me-In.mp3?rlkey=gdr374u4qgh7ogc533j7goqma&st=d3uixeoz&dl', title: 'Cada acorde, um abraço', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/jgrt6g5cxj68opbwm2aqu/Cristiano-Araujo-N-o-Sei-Me-Controlar.m4a?rlkey=s26z7ra5s94zdt2fggy5fobe4&st=v3cotsjs&dl', title: 'Nossas risadas em C maior', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/p4baiax7kiqe0a0yc5yi5/Armandinho-Eu-Juro.mp3?rlkey=d1b22jjixxa5xuo5puta51ad9&st=6huy0r1m&dl', title: 'Seu olhar em verso e refrão', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/ve92fqft44ugque6ajkhs/Shawn-Mendes-Always-Been-You.mp3?rlkey=mp9puk6t1d65df4h7b4bams50&st=y9lq0ttp&dl', title: 'Uma canção de nós dois', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/ootwtg1puatu60ucnm5kt/Taylor-Swift-Daylight.mp3?rlkey=kd8hlfztnzd3q6ifj3pa9207g&st=253iqihw&dl', title: 'Escrita a cada dia', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/bcgtzc5fqxle9q4m97wjc/Maroon-5-Sugar.mp3?rlkey=rit4mn4s423jzscg68ex89vqu&st=man60f9r&dl', title: 'Afinada em amor', artist: 'Gui & Ju' },
                { url: 'https://dl.dropboxusercontent.com/scl/fi/p4xmuvblwzk3ch2q5t59e/Mariana-Nolasco-All-Star.mp3?rlkey=ngsiahq5l5blkfn3aiszmzymn&st=scgajfpx&dl', title: 'E para sempre em play', artist: 'Gui & Ju' },
                // Adicione mais músicas aqui, seguindo o mesmo padrão.
                // Ex: { url: 'SEU_LINK_DROPBOX?raw=1', title: 'Nome da Música', artist: 'Artista' },
            ];

            let currentTrackIndex = 0;

            // --- LÓGICA DO SITE ---
            const audio = document.getElementById('audio-player');
            const albumArtContainer = document.getElementById('album-art-container');
            const songTitleElement = document.getElementById('song-title');
            const songArtistElement = document.getElementById('song-artist');
            const lyricsSongTitleElement = document.getElementById('lyrics-song-title');
            const mainPlayBtn = document.getElementById('main-play-btn');
            const lyricsPlayBtn = document.getElementById('lyrics-play-btn');
            const mainNextBtn = document.getElementById('main-next-btn');
            const mainPrevBtn = document.getElementById('main-prev-btn');
            const lyricsNextBtn = document.getElementById('lyrics-next-btn');
            const lyricsPrevBtn = document.getElementById('lyrics-prev-btn');
            const mainProgressBar = document.getElementById('main-progress-bar');
            const lyricsProgressBar = document.getElementById('lyrics-progress-bar');
            const mainProgress = document.getElementById('main-progress');
            const lyricsProgress = document.getElementById('lyrics-progress');
            const mainCurrentTime = document.getElementById('main-current-time');
            const lyricsCurrentTime = document.getElementById('lyrics-current-time');
            const mainTotalTime = document.getElementById('main-total-time');
            const lyricsTotalTime = document.getElementById('lyrics-total-time');
            const playIconSvg = `<svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>`;
            const pauseIconSvg = `<svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1zm4 0a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>`;
            const notification = document.getElementById('notification');
            const notificationSongName = document.getElementById('notification-song-name');
            let notificationTimeout;

            function showNotification(songName) {
                if (notificationTimeout) {
                    clearTimeout(notificationTimeout);
                }
                notificationSongName.textContent = songName;
                notification.classList.remove('opacity-0', '-translate-y-10'); // Anima para dentro

                notificationTimeout = setTimeout(() => {
                    notification.classList.add('opacity-0', '-translate-y-10'); // Anima para fora
                }, 3000); // A notificação some após 3 segundos
            }

            function loadTrack(trackIndex, direction = 'none') {
                const track = musicPlaylist[trackIndex];

                // Usa o título e artista definidos na playlist para a interface
                songTitleElement.textContent = track.title;
                songArtistElement.textContent = track.artist;
                lyricsSongTitleElement.textContent = track.title;

                const newImageSrcJpg = `nossafoto${trackIndex + 1}.jpg`;
                const newImg = document.createElement('img');
                newImg.src = newImageSrcJpg;
                newImg.alt = "Capa da nossa música";
                newImg.className = "absolute top-0 left-0 w-full h-full object-cover transition-transform duration-500 ease-in-out";
                newImg.onerror = function() { handleImageError(this); };
                const oldImg = albumArtContainer.querySelector('img');
                if (direction === 'next') {
                    newImg.style.transform = 'translateX(100%)';
                    albumArtContainer.appendChild(newImg);
                    setTimeout(() => {
                        if (oldImg) oldImg.style.transform = 'translateX(-100%)';
                        newImg.style.transform = 'translateX(0)';
                    }, 10);
                } else if (direction === 'prev') {
                    newImg.style.transform = 'translateX(-100%)';
                    albumArtContainer.appendChild(newImg);
                    setTimeout(() => {
                        if (oldImg) oldImg.style.transform = 'translateX(100%)';
                        newImg.style.transform = 'translateX(0)';
                    }, 10);
                } else { 
                    albumArtContainer.innerHTML = '';
                    albumArtContainer.appendChild(newImg);
                }
                if (oldImg && direction !== 'none') {
                    setTimeout(() => oldImg.remove(), 500);
                }
                audio.src = track.url;
                audio.load();
            }

            function playMusic() {
                audio.play().catch(error => console.log("Autoplay impedido.", error));
                mainPlayBtn.innerHTML = pauseIconSvg;
                mainPlayBtn.classList.remove('pulse-play');
                lyricsPlayBtn.innerHTML = pauseIconSvg;

                // Extrai o nome do arquivo da URL APENAS para a notificação
                const currentTrack = musicPlaylist[currentTrackIndex];
                const url = currentTrack.url;
                const fileNameWithQuery = url.substring(url.lastIndexOf('/') + 1);
                const fileName = fileNameWithQuery.split('?')[0];
                const decodedFileName = decodeURIComponent(fileName);

                showNotification(decodedFileName);
            }

            function pauseMusic() {
                audio.pause();
                mainPlayBtn.innerHTML = playIconSvg;
                 mainPlayBtn.classList.add('pulse-play');
                lyricsPlayBtn.innerHTML = playIconSvg;
            }

            function playNext() {
                currentTrackIndex = (currentTrackIndex + 1) % musicPlaylist.length;
                loadTrack(currentTrackIndex, 'next');
                playMusic();
            }

            function playPrevious() {
                currentTrackIndex = (currentTrackIndex - 1 + musicPlaylist.length) % musicPlaylist.length;
                loadTrack(currentTrackIndex, 'prev');
                playMusic();
            }

            function togglePlayPause() {
                if (audio.src && audio.paused) {
                    playMusic();
                } else {
                    pauseMusic();
                }
            }
            
            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
            }

            function updateProgress() {
                if (audio.duration) {
                    const progressPercent = (audio.currentTime / audio.duration) * 100;
                    mainProgress.style.width = `${progressPercent}%`;
                    lyricsProgress.style.width = `${progressPercent}%`;
                    mainCurrentTime.textContent = formatTime(audio.currentTime);
                    lyricsCurrentTime.textContent = formatTime(audio.currentTime);
                }
            }
            
            function setProgress(e, progressBar) {
                const width = progressBar.clientWidth;
                const clickX = e.offsetX;
                const duration = audio.duration;
                if (duration) {
                    audio.currentTime = (clickX / width) * duration;
                }
            }

            mainPlayBtn.addEventListener('click', togglePlayPause);
            lyricsPlayBtn.addEventListener('click', togglePlayPause);
            mainNextBtn.addEventListener('click', playNext);
            mainPrevBtn.addEventListener('click', playPrevious);
            lyricsNextBtn.addEventListener('click', playNext);
            lyricsPrevBtn.addEventListener('click', playPrevious);
            audio.addEventListener('timeupdate', updateProgress);
            audio.addEventListener('loadedmetadata', () => {
                mainTotalTime.textContent = formatTime(audio.duration);
                lyricsTotalTime.textContent = formatTime(audio.duration);
                updateProgress();
            });
            audio.addEventListener('ended', playNext);
            mainProgressBar.addEventListener('click', (e) => setProgress(e, mainProgressBar));
            lyricsProgressBar.addEventListener('click', (e) => setProgress(e, lyricsProgressBar));

            loadTrack(currentTrackIndex);
            pauseMusic();
            
            // --- Lógica de Swipe na Capa do Álbum ---
            let touchStartX = 0;
            let touchEndX = 0;

            albumArtContainer.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            }, { passive: true });

            albumArtContainer.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleAlbumSwipe();
            }, { passive: true });

            function handleAlbumSwipe() {
                const swipeThreshold = 50; // Mínimo de pixels para considerar um swipe
                if (touchStartX - touchEndX > swipeThreshold) {
                    // Swipe para a esquerda (próxima música)
                    playNext();
                } else if (touchEndX - touchStartX > swipeThreshold) {
                    // Swipe para a direita (música anterior)
                    playPrevious();
                }
            }

            const mainPage = document.getElementById('main-page');
            const lyricsPage = document.getElementById('lyrics-page');
            const lyricsCard = document.getElementById('lyrics-card');
            const backToMainBtn = document.getElementById('back-to-main-btn');
            const storiesContainer = document.getElementById('stories-container');
            const eventsContainer = document.getElementById('events-container');
            const storyModal = document.getElementById('story-modal');
            const closeStoryBtn = document.getElementById('close-story-btn');
            const lyricsContent = document.getElementById('lyrics-content');

            lyricsCard.addEventListener('click', () => {
                lyricsPage.style.transform = '';
                lyricsPage.classList.remove('hidden');
                mainPage.classList.add('hidden');
            });

            function closeLyricsPage() {
                mainPage.classList.remove('hidden');
                lyricsPage.classList.add('hidden');
            }

            backToMainBtn.addEventListener('click', closeLyricsPage);

            // --- LÓGICA DOS STORIES ---
            let currentStoryIndex = 0;
            let currentStoryImageSubIndex = 0;
            let storyTimer;

            storiesData.forEach((story, index) => {
                const storyElement = document.createElement('div');
                storyElement.className = 'flex flex-col items-center flex-shrink-0 w-16';
                const thumbnailSrc = `${(index + 1) * 10}.jpg`;
                storyElement.innerHTML = `
                    <div class="w-14 h-14 rounded-full p-0.5 bg-gradient-to-tr from-yellow-400 via-red-500 to-purple-500">
                        <img src="${thumbnailSrc}" class="w-full h-full rounded-full object-cover border-2 border-black" onerror="handleImageError(this)">
                    </div>
                    <span class="text-xs mt-1 text-center text-gray-300">${story.title}</span>`;
                storyElement.addEventListener('click', () => openStory(index));
                storiesContainer.appendChild(storyElement);
            });
            
            const storyProgressContainer = document.getElementById('story-progress-container');
            const storyModalAvatar = document.getElementById('story-modal-avatar');
            const storyModalTitle = document.getElementById('story-modal-title');
            const storyModalImage = document.getElementById('story-modal-image');
            const storyModalText = document.getElementById('story-modal-text');
            const storyPrevZone = document.getElementById('story-prev-zone');
            const storyNextZone = document.getElementById('story-next-zone');

            function openStory(storyIndex) {
                currentStoryIndex = storyIndex;
                currentStoryImageSubIndex = 0;
                
                storyModal.classList.remove('hidden');
                storyModal.classList.add('flex');
                
                // Prepara a visualização do story antes de carregar a primeira imagem
                updateStoryView();
            }
            
            function updateStoryView() {
                const story = storiesData[currentStoryIndex];
                
                storyProgressContainer.innerHTML = '';
                for (let i = 0; i < story.imageCount; i++) {
                    const barSegment = document.createElement('div');
                    barSegment.className = 'bg-gray-600 rounded-full h-full flex-1';
                    barSegment.innerHTML = `<div class="bg-white h-full rounded-full" style="width: ${i < currentStoryImageSubIndex ? '100%' : '0%'};"></div>`;
                    storyProgressContainer.appendChild(barSegment);
                }

                storyModalTitle.innerText = story.title;
                storyModalText.innerText = story.text;
                storyModalAvatar.src = `${(currentStoryIndex + 1) * 10}.jpg`;
                
                // Garante que o navegador está pronto para a animação
                requestAnimationFrame(() => {
                    loadStoryImage();
                });
            }

            function loadStoryImage() {
                if (storyTimer) clearTimeout(storyTimer);

                const imageNumber = (currentStoryIndex + 1) * 10 + currentStoryImageSubIndex;
                storyModalImage.src = `${imageNumber}.jpg`;

                const progressBars = storyProgressContainer.querySelectorAll('div > div');
                const currentProgressBar = progressBars[currentStoryImageSubIndex];

                if (currentProgressBar) {
                    currentProgressBar.classList.remove('story-progress-bar-segment');
                    void currentProgressBar.offsetWidth; // Força reflow
                    currentProgressBar.classList.add('story-progress-bar-segment');
                }

                storyTimer = setTimeout(nextStoryImage, 5000);
            }

            function nextStoryImage() {
                const story = storiesData[currentStoryIndex];
                if (currentStoryImageSubIndex < story.imageCount - 1) {
                    currentStoryImageSubIndex++;
                    loadStoryImage();
                } else if (currentStoryIndex < storiesData.length - 1) {
                    currentStoryIndex++;
                    currentStoryImageSubIndex = 0;
                    updateStoryView();
                } else {
                    closeStory();
                }
            }

            function prevStoryImage() {
                if (currentStoryImageSubIndex > 0) {
                    currentStoryImageSubIndex--;
                    updateStoryView();
                } else if (currentStoryIndex > 0) {
                    currentStoryIndex--;
                    const prevStory = storiesData[currentStoryIndex];
                    currentStoryImageSubIndex = prevStory.imageCount - 1;
                    updateStoryView();
                } else {
                    // Reinicia a primeira imagem da primeira história
                     updateStoryView();
                }
            }

            function closeStory() {
                if (storyTimer) clearTimeout(storyTimer);
                storyModal.classList.add('hidden');
                storyModal.classList.remove('flex');
            }

            closeStoryBtn.addEventListener('click', closeStory);
            storyNextZone.addEventListener('click', nextStoryImage);
            storyPrevZone.addEventListener('click', prevStoryImage);
            
            // --- LÓGICA DOS EVENTOS ---
            const eventModal = document.getElementById('ticket-event-modal');
            const cinemaEventModal = document.getElementById('cinema-event-modal');
            const randomEventModal = document.getElementById('random-event-modal');
            
            let calendarInterval;

            eventsData.forEach((event, index) => {
                const eventElement = document.createElement('div');
                const imageSrc = `E${index + 1}.jpg`;
                eventElement.className = 'flex flex-col items-center flex-shrink-0 w-16 text-center cursor-pointer';
                eventElement.innerHTML = `
                    <div class="w-14 h-14 rounded-full">
                        <img src="${imageSrc}" class="w-full h-full rounded-full object-cover border-2 border-gray-600" onerror="handleImageError(this)">
                    </div>
                    <span class="text-xs mt-1 text-gray-300">${event.title}</span>`;
                eventElement.addEventListener('click', () => openEventModal(event));
                eventsContainer.appendChild(eventElement);
            });

            function openEventModal(event) {
                const modalId = `${event.type}-event-modal`;
                const modal = document.getElementById(modalId);
                if (!modal) return;
                
                const ticket = modal.querySelector('div');
                const title = modal.querySelector('h2');

                if(title) title.textContent = event.title;
                modal.classList.remove('hidden');
                setTimeout(() => {
                   ticket.classList.remove('scale-95', 'opacity-0');
                }, 10);
                
                if (event.type === 'ticket') {
                    const calendarAnimation = document.getElementById('calendar-animation');
                    const ticketMainText = document.getElementById('ticket-main-text');
                    const ticketSubText = document.getElementById('ticket-sub-text');
                    
                    if (ticketMainText) ticketMainText.textContent = event.mainText;
                    if (ticketSubText) ticketSubText.textContent = event.subText;

                    if(calendarInterval) clearInterval(calendarInterval);
                    calendarInterval = setInterval(() => {
                        calendarAnimation.textContent = Math.floor(Math.random() * 30) + 1;
                    }, 80);
                }
            }

            function closeModal(modal) {
                 const ticket = modal.querySelector('div');
                 if(modal.id === 'ticket-event-modal' && calendarInterval) clearInterval(calendarInterval);
                 ticket.classList.add('scale-95', 'opacity-0');
                 setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            }

            eventModal.addEventListener('click', (e) => {
                if (e.target === eventModal) closeModal(eventModal);
            });
             cinemaEventModal.addEventListener('click', (e) => {
                if (e.target === cinemaEventModal) closeModal(cinemaEventModal);
            });
            randomEventModal.addEventListener('click', (e) => {
                if (e.target === randomEventModal) closeModal(randomEventModal);
            });


            // --- LÓGICA DE ARRASTAR ---
            let touchStartY = 0;
            let currentY = 0;
            let isDragging = false;

            function addDragToCloseListener(modal, onDragStart, onDrag, onDragEnd) {
                 modal.addEventListener('touchstart', onDragStart);
                 modal.addEventListener('touchmove', onDrag);
                 modal.addEventListener('touchend', onDragEnd);
            }

            // Arrastar para fechar Story
            addDragToCloseListener(storyModal, 
                (e) => {
                    isDragging = true;
                    touchStartY = e.touches[0].clientY;
                    storyModal.style.transition = 'none';
                    if(storyTimer) clearTimeout(storyTimer);
                },
                (e) => {
                    if (!isDragging) return;
                    currentY = e.touches[0].clientY;
                    const diffY = currentY - touchStartY;
                    if (diffY > 0) {
                        storyModal.style.transform = `translateY(${diffY}px)`;
                        storyModal.style.opacity = 1 - (diffY / (window.innerHeight / 1.5));
                    }
                },
                () => {
                    if (!isDragging) return;
                    isDragging = false;
                    const diffY = currentY - touchStartY;
                    storyModal.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
                    if (diffY > window.innerHeight / 4) {
                        storyModal.style.transform = 'translateY(100%)';
                        storyModal.style.opacity = '0';
                        setTimeout(() => closeStory(), 300);
                    } else {
                        storyModal.style.transform = 'translateY(0)';
                        storyModal.style.opacity = '1';
                        storyTimer = setTimeout(nextStoryImage, 5000 - ( (performance.now() % 5000) || 0) );
                    }
                }
            );

            // Arrastar para fechar Letra
            addDragToCloseListener(lyricsPage,
                (e) => {
                    if (lyricsContent.scrollTop === 0) {
                        isDragging = true;
                        touchStartY = e.touches[0].clientY;
                        lyricsPage.style.transition = 'none';
                    } else {
                        isDragging = false;
                    }
                },
                (e) => {
                    if (!isDragging) return;
                    currentY = e.touches[0].clientY;
                    const diffY = currentY - touchStartY;
                    if (diffY > 0) { 
                        lyricsPage.style.transform = `translateY(${diffY}px)`;
                    }
                },
                () => {
                    if (!isDragging) return;
                    isDragging = false;
                    const diffY = currentY - touchStartY;
                    lyricsPage.style.transition = 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                    if (diffY > window.innerHeight / 4) {
                        closeLyricsPage();
                    } else {
                        lyricsPage.style.transform = ''; 
                    }
                }
            );

             // --- Lógica do Menu do Cabeçalho ---
            const menuBtn = document.getElementById('menu-btn');
            const headerMenu = document.getElementById('header-menu');

            menuBtn.addEventListener('click', (event) => {
                event.stopPropagation(); 
                headerMenu.classList.toggle('hidden');
            });
            
            document.addEventListener('click', (event) => {
                if (!headerMenu.classList.contains('hidden') && !headerMenu.contains(event.target) && !menuBtn.contains(event.target)) {
                    headerMenu.classList.add('hidden');
                }
            });
        });
    </script>
</body>
</html>

